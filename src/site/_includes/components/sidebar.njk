<aside>
      <div class="sidebar">
            <div class="sidebar-container">
                  {% for imp in dynamics.sidebar.top %}
                        {% include imp %}
                  {% endfor %}
                  {# Only show filetree in right sidebar if left sidebar filetree is not shown #}
                  {%if settings.dgShowFileTree !== true%}
                        <div class="filetree-in-sidebar">
                              <div class="filetree-title-container">
                                    <div class="filetree-title">Notes</div>
                              </div>
                              <div class="filetree-container">
                                    {% macro menuItem(fileOrFolderName, fileOrFolder, step, currentPath) %}
                                          {%if fileOrFolder.isNote or fileOrFolder.isFolder%}
                                                <div x-show="isOpen" style="display:none" class="{{'filelist' if step>0}}">
                                                      {%if fileOrFolder.isNote and not fileOrFolder.hide %}
                                                            <div @click.stop class="notelink {{ 'active-note' if fileOrFolder.permalink === permalink}}">
                                                                  {%- if not meta.noteIconsSettings.filetree -%}<i icon-name="sticky-note" aria-hidden="true"></i>{%- endif -%}
                                                                  <a data-note-icon="{{fileOrFolder.noteIcon}}" style="text-decoration: none;" class="filename" href="{{fileOrFolder.permalink}}">{{fileOrFolder.name}} </a>
                                                            </div>
                                                      {% elif fileOrFolder.isFolder%}
                                                            <div class="folder inner-folder"  x-data="{isOpen: $persist(false).as({{currentPath | dump}})}" @click.stop="isOpen=!isOpen">
                                                                  <div class="foldername-wrapper align-icon">
                                                                  <i x-show="isOpen" style="display: none;"  icon-name="chevron-down"></i>
                                                                  <i x-show="!isOpen"  icon-name="chevron-right"></i>
                                                                  <span class="foldername">{{fileOrFolderName}}</span>
                                                                  </div>
                                                                  {% for fileOrFolderName, child in fileOrFolder %}
                                                                        {{menuItem(fileOrFolderName, child, step+1, (currentPath+"/"+fileOrFolderName))}}
                                                                  {% endfor %}
                                                            </div>
                                                      {% endif %}
                                                </div>
                                                {%endif%}
                                          {% endmacro %}
                                    <div class="folder" x-data="{isOpen: true}">
                                          {%- for fileOrFolderName, fileOrFolder in filetree -%}
                                                {{menuItem(fileOrFolderName, fileOrFolder, 0, fileOrFolderName)}}
                                          {%- endfor -%}
                                    </div>
                              </div>
                        </div>
                  {%endif%}
                  {%set tocHtml= (content and (content|toc)) %}
                  {%if tocHtml %}
                        <div class="toc">
                              <div class="toc-title-container">
                                    <div class="toc-title">
                                          On this page
                                    </div>
                              </div>
                              <div class="toc-container">
                                    {{ tocHtml | safe }}
                              </div>
                        </div>
                  {%endif%}

                  {%if settings.dgShowLocalGraph === true%}
                        {%include "components/graphScript.njk"%}
                  {%endif%}

                        {%if settings.dgShowBacklinks === true %}
                              {%if settings.dgShowBacklinks === true %}
                              <div class="backlinks">
                                    <div class="backlink-title" style="margin: 4px 0 !important;">Pages mentioning this page</div>
                                          <div class="backlink-list">
                                          {%- if page.url == "/" -%}
                                                {%- if graph.nodes[graph.homeAlias].backLinks.length === 0 -%}
                                                      <div class="backlink-card">
                                                            <span class="no-backlinks-message">No other pages mentions this page</span>
                                                      </div>
                                                {%- endif -%}
                                          {%- for backlink in graph.nodes[graph.homeAlias].backLinks -%}
                                                {%- if graph.nodes[backlink].url != graph.homeAlias -%}
                                                <div class="backlink-card">
                                                      {%- if not meta.noteIconsSettings.backlinks -%}<i  icon-name="link"></i> {%- endif -%}<a href="{{graph.nodes[backlink].url}}" data-note-icon="{{graph.nodes[backlink].noteIcon}}" class="backlink">{{graph.nodes[backlink].title}}</a>
                                                </div>
                                                {%- endif -%}
                                          {%- endfor -%}
                                          {%- else -%}
                                                {%- if graph.nodes[page.url].backLinks.length === 0 -%}
                                                      <div class="backlink-card">
                                                            <span class="no-backlinks-message">No other pages mentions this page</span>
                                                      </div>
                                                {%- endif -%}
                                          {%- for backlink in graph.nodes[page.url].backLinks -%}
                                                {%- if graph.nodes[backlink].url != page.url -%}
                                                <div class="backlink-card">
                                                      {%- if not meta.noteIconsSettings.backlinks -%}<i  icon-name="link"></i> {%- endif -%}<a href="{{graph.nodes[backlink].url}}" data-note-icon="{{graph.nodes[backlink].noteIcon}}" class="backlink">{{graph.nodes[backlink].title}}</a>
                                                </div>
                                                {%- endif -%}
                                          {%- endfor -%}
                                    {%- endif -%}
                                    </div>
                              </div>
                        {%endif%}
                  {%endif%}
                  {% for imp in dynamics.sidebar.bottom %}
                        {% include imp %}
                  {% endfor %}
            </div>
      </div>
</aside>